<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –ì–∏–¥ –ø–æ –ù–∏–∂–Ω–µ–º—É –ù–æ–≤–≥–æ—Ä–æ–¥—É - –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—É—Ç–µ–≤–æ–¥–∏—Ç–µ–ª—å</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU&amp;apikey={{ yandex_api }}" type="text/javascript"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
    <div class="animated-background">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <div class="main-container">
        <header class="hero-section">
            <div class="hero-content">
                <div class="hero-badge">
                    <span class="badge-icon">ü§ñ</span>
                    <span>AI-Powered –¢—É—Ä–∏–∑–º</span>
                </div>
                <h1 class="hero-title">
                    –û—Ç–∫—Ä–æ–π—Ç–µ –¥–ª—è —Å–µ–±—è<br>
                    <span class="gradient-text">–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥</span>
                </h1>
                <p class="hero-description">
                    –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π AI-–≥–∏–¥ —Å–æ–∑–¥–∞—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å,
                    —É—á–∏—Ç—ã–≤–∞—è –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏ –≤—Ä–µ–º—è
                </p>
            </div>
        </header>

        <div class="form-card glass-effect">
            <div class="form-header">
                <h2>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –º–∞—Ä—à—Ä—É—Ç</h2>
                <p>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –ø–æ–ª—É—á–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –ø—Ä–æ–≥—É–ª–∫–∏</p>
            </div>

            <form method="POST" id="routeForm">
                <div class="input-group">
                    <label for="interests">
                        <span class="label-icon">‚ú®</span>
                        –í–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã
                    </label>
                    <input type="text" id="interests" name="interests" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –∏—Å—Ç–æ—Ä–∏—è, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –µ–¥–∞, –∏—Å–∫—É—Å—Å—Ç–≤–æ..." required autocomplete="off">
                    <div class="input-underline"></div>
                </div>

                <div class="input-group">
                    <label for="time">
                        <span class="label-icon">‚è±Ô∏è</span>
                        –í—Ä–µ–º—è –Ω–∞ –ø—Ä–æ–≥—É–ª–∫—É
                    </label>
                    <input type="number" id="time" name="time" placeholder="–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤" min="1" max="12" required autocomplete="off">
                    <div class="input-underline"></div>
                    <small class="input-hint">–û—Ç 1 –¥–æ 12 —á–∞—Å–æ–≤</small>
                </div>

                <div class="input-group">
                    <label for="location">
                        <span class="label-icon">üìç</span>
                        –í–∞—à–µ —Ç–µ–∫—É—â–µ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
                    </label>
                    <input type="text" id="location" name="location" placeholder="–ê–¥—Ä–µ—Å –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å" required autocomplete="off">
                    <div class="input-underline"></div>
                </div>

                <div id="map1" style="width: 100%; height: 400px; border-radius: 15px; overflow: hidden;"></div>
                <script>
                    ymaps.ready(function () {
                        var myMap = new ymaps.Map("map1", {
                            center: [56.3287, 44.002], 
                            zoom: 13
                        });
                        var placemark = new ymaps.Placemark([56.3287, 44.002], {
                            balloonContent: '–í–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ'
                        });
                        myMap.geoObjects.add(placemark);
                        myMap.events.add('click', function (e) {
                            var coords = e.get('coords'); 
                            placemark.geometry.setCoordinates(coords);
                            placemark.properties.set('balloonContent', '–í—ã –≤—ã–±—Ä–∞–ª–∏ —ç—Ç—É —Ç–æ—á–∫—É');

                            var latitude = coords[0].toFixed(6); 
                            var longitude = coords[1].toFixed(6);
                            document.getElementById('location').value = latitude + ', ' + longitude;
                        });
                    });
                </script>


                <button type="submit" id="submitBtn" class="submit-btn">
                    <span class="btn-text">–°–æ–∑–¥–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç</span>
                    <span class="btn-icon">‚Üí</span>
                </button>
            </form>

            <div id="loader" class="loader" style="display: none;">
                <div class="loader-spinner"></div>
                <p class="loader-text">–°–æ–∑–¥–∞—é –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç...</p>
                <div class="loader-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>

        {% if plan %}
        <div id="results" class="results-section">
            <div class="plan-card glass-effect">
                <div class="card-header">
                    <div class="header-icon-wrapper">
                        <span class="header-icon">üó∫Ô∏è</span>
                    </div>
                    <div>
                        <h2>–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç</h2>
                        <p class="card-subtitle">–°–æ–∑–¥–∞–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –≤–∞—Å —Å –ø–æ–º–æ—â—å—é AI</p>
                    </div>
                </div>

                <div class="plan-content">
                    {{ plan | safe }}
                </div>

                <div class="card-footer">
                    <button onclick="window.print()" class="secondary-btn">
                        <span>üñ®Ô∏è</span>
                        –†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –º–∞—Ä—à—Ä—É—Ç
                    </button>
                    <button onclick="shareRoute()" class="secondary-btn">
                        <span>üì§</span>
                        –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
                    </button>
                </div>
            </div>

            <div class="map-card glass-effect">
                <div class="card-header">
                    <div class="header-icon-wrapper">
                        <span class="header-icon">üåç</span>
                    </div>
                    <div>
                        <h2>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞</h2>
                        <p class="card-subtitle">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∞—à–µ–≥–æ –º–∞—Ä—à—Ä—É—Ç–∞</p>
                    </div>
                </div>
                <div id="map2" class="map-container"></div>
            </div>
        </div>
        {% endif %}

        <footer class="footer">
            <p>
                –°–æ–∑–¥–∞–Ω–æ —Å üíô –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π
                <span class="separator">‚Ä¢</span>
                Powered by AI
            </p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

    {% if plan %}
    <script type="text/javascript">
        ymaps.ready(function () {
            var map = new ymaps.Map('map2', {
                center: [56.3287, 44.002],
                zoom: 13,
                controls: ['zoomControl', 'typeSelector', 'fullscreenControl']
            }, {
                searchControlProvider: 'yandex#search'
            });

            map.behaviors.enable('scrollZoom');

            var placemark = new ymaps.Placemark(
                [56.3287, 44.002],
                {
                    iconContent: '–°—Ç–∞—Ä—Ç',
                    balloonContent: '<strong>–ù–∞—á–∞–ª–æ –º–∞—Ä—à—Ä—É—Ç–∞</strong><br>–í–∞—à–µ —Ç–µ–∫—É—â–µ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ'
                },
                {
                    preset: 'islands#redStretchyIcon',
                    draggable: false
                }
            );

            map.geoObjects.add(placemark);

            setTimeout(function() {
                placemark.balloon.open();
            }, 1000);
        });

        function shareRoute() {
            if (navigator.share) {
                navigator.share({
                    title: '–ú–æ–π –º–∞—Ä—à—Ä—É—Ç –ø–æ –ù–∏–∂–Ω–µ–º—É –ù–æ–≤–≥–æ—Ä–æ–¥—É',
                    text: '–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –º–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π AI-–≥–∏–¥–æ–º!',
                    url: window.location.href
                }).catch(() => {});
            } else {
                navigator.clipboard.writeText(window.location.href);
                showNotification('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
    </script>
    {% endif %}
</body>
</html>
